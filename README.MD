Slightly modified from zhedong zheng's codes.
